<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>FriendFinder Survey</title>

    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>-->

    <!-- Materialize -->
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
</head>

<body>

    <div class="container">
        <h1>Survey Questions</h1>
        <br>
        <h5>Your name</h5>
        <input type="text" id="nameInput" class="form-control">
        <h5>Link to your picture</h5>
        <input type="text" id="photoInput" class="form-control">

        <!--Questions start here-->
        <!--Structure taken from Materialize-->
        <div id="survey">
            <h3><strong>Question 1</strong></h3>
            <h5> It is customary to tip when you pick up a to-go order from a nice restaurant. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 2</strong></h3>
            <h5> You should always say "bless you" after someone sneezes. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 3</strong></h3>
            <h5> If someone has food stuck in their teeth, it is rude not to inform them. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 4</strong></h3>
            <h5> More often than not, saying goodbye is an arduous and complicated social exercise. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 5</strong></h3>
            <h5> "Ironic" is the most abused and misused word in the English language. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 6</strong></h3>
            <h5> You are spineless if you refuse to take a side in a political discussion. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 7</strong></h3>
            <h5> Surveys are mostly flawed because most people don't really know themselves and therefore misrepresent their own true feelings. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 8</strong></h3>
            <h5> Keeping up with friends is something I look forward to and genuinely enjoy. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 9</strong></h3>
            <h5> Calling an old friend to catch up is much better than texting them. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>

            <h3><strong>Question 10</strong></h3>
            <h5> Apples should always be washed before they are eaten. </h5>

            <div class="input-field col s12">
                <select required>
              <option value="" disabled selected>Choose your option</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
            </div>
        </div>
        <!--find friend button-->
        <div class="col s12 center-align">
            <div id="findFriendbtn" class="btn">Find my friend!</div>
        </div>

        <br>

        <!--modal goes here to display the best friend to the new friend-->
        <div class="col s12 center-align">
            <!-- Modal Trigger -->
            <a class="waves-effect waves-light btn modal-trigger" href="#modal1">View My Friend!</a>

            <!-- Modal Structure -->
            <div id="modal1" class="modal">
                <div id="bestFriend" class="modal-content">
                    <h4>You haven't found your best friend yet! Finish the survey and hit "Find my friend!" first!</h4>
                    <img id="photo">
                </div>
                <div class="modal-footer">
                    <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
                </div>
            </div>
        </div>


    </div>

    <footer class="bd-footer">
        <div class="container">
            <ul class="bd-footer-links">
                <li><a href="api/friends">API Friends List</a></li>
                <li><a href="https://github.com/tmiess/FriendFinder">Github Repo</a></li>
            </ul>
        </div>
    </footer>

    <script>
        /*global $*/

        // initialize dropdown input fields and modal
        $(document).ready(function() {
            $('select').material_select();
            $('.modal').modal({
                dismissible: true,
                opacity: .5,
                ready: function(modal, trigger) {
                    console.log(modal, trigger);
                },
                complete: function() {} // Callback for Modal close
            });
        });


        $("#findFriendbtn").click(function() {
            event.preventDefault();

            ////////console.log tests/////////
            console.log("console.log tests begin:");
            console.log("jquery connected");
            console.log("name input: " + $("#nameInput"));
            console.log("newFriend: " + newFriend);
            console.log("console.log tests complete.");
            //////////////////////////////////

            var name = $("#nameInput").val().trim();
            var photo = $("#photoInput").val().trim();
            var answers = $("#survey select :selected");
            var surveyData = [];

            //check that name and photo are complete
            if (name.length === 0) {
                alert("survey not complete! Please enter a name.");
            }

            else if (photo.length === 0) {
                alert("survey not complete! Please enter an image link.");
            }

            // check that all questions have been answered
            for (var i = 0; i < answers.length; i++) {
                var answer = (parseInt(answers.eq(i).val()));
                if (Number.isInteger(answer) === false) {
                    alert("survey not complete! Please answer all questions.");
                    return;
                }
                surveyData.push(parseInt(answers.eq(i).val()));
            }

            // create new friend to push to api/friends
            var newFriend = {
                "name": name,
                "photo": photo,
                "answers": surveyData
            };

            $.ajax({
                url: "/api/friends",
                method: "POST",
                data: newFriend,
                traditional: true
            }).done(function(data) {
                $("#bestFriend").text(data.name + "!");
                $("#bestFriend img").attr({ 'src': data.photo });
                $("#bestFriend").modal("show");
            });

        });
    </script>
</body>



</html>
